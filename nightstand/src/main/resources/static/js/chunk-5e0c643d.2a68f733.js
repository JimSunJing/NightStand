(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5e0c643d"],{"1dde":function(t,e,r){var n=r("d039"),i=r("b622"),o=r("2d00"),a=i("species");t.exports=function(t){return o>=51||!n((function(){var e=[],r=e.constructor={};return r[a]=function(){return{foo:1}},1!==e[t](Boolean).foo}))}},"1deb":function(t,e,r){"use strict";r.r(e);var n=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("b-container",[r("b-row",{staticClass:"justify-content-center mt-4"},[r("h1",{staticStyle:{color:"white"}},[t._v("图书列表编辑")])]),r("b-row",{staticClass:"justify-content-center mt-4"},[r("b-col",{attrs:{md:"4"}},[r("b-card",{attrs:{"bg-variant":"dark","text-variant":"light"},scopedSlots:t._u([{key:"header",fn:function(){return[r("h3",{attrs:{align:"center"}},[t._v("列表内容")])]},proxy:!0}])},[r("b-form-group",{attrs:{label:"标题","label-for":"textarea-title"}},[r("b-form-input",{attrs:{id:"textarea-title",placeholder:"请输入安利列表的标题"},model:{value:t.recommendForm.title,callback:function(e){t.$set(t.recommendForm,"title",e)},expression:"recommendForm.title"}})],1),r("b-form-group",{attrs:{label:"描述","label-for":"textarea-text"}},[r("b-form-textarea",{attrs:{id:"textarea-text",placeholder:"请输入安利列表的描述",rows:"5"},model:{value:t.recommendForm.text,callback:function(e){t.$set(t.recommendForm,"text",e)},expression:"recommendForm.text"}})],1)],1)],1),r("b-col",[r("b-card",{attrs:{"bg-variant":"dark","text-variant":"light",align:"center"},scopedSlots:t._u([{key:"header",fn:function(){return[r("h3",{attrs:{align:"center"}},[t._v("条目列表")])]},proxy:!0}])},[r("b-list-group",t._l(t.addList,(function(e,n){return r("b-list-group-item",{key:n,attrs:{button:"",variant:"dark"},on:{click:function(e){return t.deleteItem(t.addList,n)}}},[r("div",{attrs:{align:"center"}},[t._v(t._s(e.title))])])})),1),r("b-button",{staticClass:"mt-4",attrs:{variant:"warning"},on:{click:t.submitForm}},[t._v("提交")]),r("b-card-footer",[t._v("单击条目可移除")])],1)],1),r("b-col",{attrs:{md:"5"}},[r("b-card",{attrs:{"bg-variant":"dark","text-variant":"light",align:"center"},scopedSlots:t._u([{key:"header",fn:function(){return[r("h3",{attrs:{align:"center"}},[t._v("添加条目")])]},proxy:!0}])},[r("b-row",{staticClass:"mt-3"},[r("b-col",[r("b-form-input",{attrs:{placeholder:"请输入需要搜索的内容，并在下面选择"},model:{value:t.searchText,callback:function(e){t.searchText=e},expression:"searchText"}})],1),r("b-col",{attrs:{md:"auto"}},[r("b-button",{staticClass:"ml-2",attrs:{variant:"success"},on:{click:t.getDoubanSearch}},[t._v("搜索")])],1)],1),r("b-row",{staticClass:"mt-3"},[r("b-col",[r("b-form-select",{attrs:{options:t.options},model:{value:t.selected,callback:function(e){t.selected=e},expression:"selected"}})],1),r("b-col",{attrs:{md:"auto"}},[r("b-button",{staticClass:"ml-2",attrs:{variant:"info"},on:{click:t.addToList}},[t._v(" 添加 ")])],1)],1)],1)],1)],1)],1)},i=[],o=(r("caad"),r("a434"),r("2532"),{name:"BookEdit",data:function(){return{selected:null,options:[{value:{},text:"请在搜索框搜索图书条目"}],addList:[],searchText:"",recommendForm:{uid:0,title:"",text:"",items:"",pubTime:""}}},methods:{addToList:function(){this.addList.includes(this.selected)||null==this.selected.id||this.addList.push(this.selected)},getDoubanSearch:function(){var t=this,e="/dbook/j/subject_suggest?q="+encodeURI(this.searchText);this.getRequest(e).then((function(e){e&&t.parseOptions(e)}))},parseOptions:function(t){for(var e=[],r=0;r<t.length;r++)if("b"===t[r].type){var n={value:{id:t[r].id,type:"b",title:t[r].title},text:t[r].title+" ("+t[r].year+") "+t[r].author_name};e.push(n)}this.options=e},deleteItem:function(t,e){t.splice(e,1)},submitForm:function(){var t=this;this.addList.length>0&&this.recommendForm.title.length>0&&(this.recommendForm.items=this.addList,this.recommendForm.uid=this.$store.state.currentUser.id,this.recommendForm.pubTime=new Date,this.postRequest("/recommendlist/basic/",this.recommendForm).then((function(e){200==e.status&&t.$router.push("/book/main")})))}}}),a=o,s=r("2877"),c=Object(s["a"])(a,n,i,!1,null,"409e2f76",null);e["default"]=c.exports},2532:function(t,e,r){"use strict";var n=r("23e7"),i=r("5a34"),o=r("1d80"),a=r("ab13");n({target:"String",proto:!0,forced:!a("includes")},{includes:function(t){return!!~String(o(this)).indexOf(i(t),arguments.length>1?arguments[1]:void 0)}})},"46aa":function(t,e,r){"use strict";r.r(e);var n=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("b-container",[r("b-row",{staticClass:"justify-content-center mt-4"},[r("b-col",{attrs:{md:"12"}},[r("h1",{staticClass:"mt-4",staticStyle:{color:"white"},attrs:{align:"center"}},[t._v("书单")])])],1),r("b-row",{staticClass:"justify-content-center mt-4"},[r("b-col",{attrs:{md:"auto"}},[r("b-card-group",{attrs:{columns:"",id:"recommend-lists"}},t._l(t.bookLists,(function(e,n){return r("b-card",{key:n,attrs:{"bg-variant":"dark","text-variant":"white"},scopedSlots:t._u([{key:"header",fn:function(){return[r("h3",{attrs:{align:"center"}},[t._v(t._s(e.title))])]},proxy:!0}],null,!0)},[r("b-card-text",{staticClass:"mt-2"},[null!=t.userInfo[e.uid]?r("div",{attrs:{align:"center"}},[t._v(" "+t._s(t.userInfo[e.uid].name)+" "),r("b-img",{attrs:{width:"30",height:"30",alt:"头像",src:t.userInfo[e.uid].userface,rounded:"circle"}})],1):t._e(),r("p",[t._v(t._s(e.text))])]),r("b-list-group",{staticClass:"mt-2"},t._l(e.items.slice(0,10),(function(n,i){return r("b-list-group-item",{key:i,attrs:{variant:"dark",id:"book-list-"+e.id+"-item-"+i,button:""}},[r("div",{attrs:{align:"center"}},[t._v(t._s(n.title))]),r("b-popover",{attrs:{target:"book-list-"+e.id+"-item-"+i,triggers:"click"},on:{show:function(e){return t.getDetail(n)},hidden:t.resetPopOver},scopedSlots:t._u([{key:"title",fn:function(){return[t._v(t._s(t.popoverItem.title))]},proxy:!0}],null,!0)},[r("b-img",{attrs:{thumbnail:"",src:t.popImageUrl,center:""}}),r("br"),r("ul",[r("li",[t._v("评分: "+t._s(t.popoverItem.rating.average))]),r("li",[t._v("作者: "+t._s(t.popoverItem.author.join(",")))]),r("li",[t._v("isbn: "+t._s(t.popoverItem.isbn10+" | "+t.popoverItem.isbn13))]),r("li",[t._v("出版社: "+t._s(t.popoverItem.publisher))]),r("li",[t._v("简介: "+t._s(t.popoverItem.summary))])])],1)],1)})),1)],1)})),1),r("b-pagination",{attrs:{"total-rows":t.pagination.total,"per-page":t.pagination.perPage,"aria-controls":"recommend-lists",align:"center"},model:{value:t.pagination.currentPage,callback:function(e){t.$set(t.pagination,"currentPage",e)},expression:"pagination.currentPage"}})],1)],1)],1)},i=[],o=(r("ac1f"),r("5319"),{name:"BookPopular",data:function(){return{bookLists:[],popoverItem:{image:"",author:"",isbn10:"",isbn13:"",publisher:"",rating:{average:""},attrs:{}},popImageUrl:"",pagination:{prePage:5,currentPage:1,total:0},userInfo:{}}},mounted:function(){this.getMovieLists()},watch:{pagination:"getMovieList"},methods:{getMovieLists:function(){var t=this,e="/recommendlist/basic/book/page/"+this.pagination.currentPage+"/"+this.pagination.prePage;this.getRequest(e).then((function(e){e&&(t.bookLists=e,t.userInfoUpdate(e),t.show=!1,t.$nextTick((function(){t.show=!0})))}))},userInfoUpdate:function(t){for(var e=0;e<t.length;e++)this.getUserInfo(t[e].uid);console.log(this.userInfo)},getUserInfo:function(t){var e=this,r="/user/info/"+t;this.getRequest(r).then((function(r){r&&(e.userInfo[t]=r)}))},getDetail:function(t){var e=this,r=t.id,n="/dapi/v2";switch(t.type){case"f":n=n+"/movie/"+r;break;case"b":n=n+"/book/"+r;break;case"m":n=n+"/music/"+r;break}this.getRequest(n).then((function(t){t&&(e.popoverItem=t,e.popImageUrl=e.imageUrlCut(t.image))}))},imageUrlCut:function(t){return t.replace(/https:\/\/img\d.doubanio.com/i,"/dpic")},resetPopOver:function(){this.popImageUrl="",this.popoverItem={alt_title:"",image:"",summary:"",rating:{average:""},attrs:{}}}}}),a=o,s=r("2877"),c=Object(s["a"])(a,n,i,!1,null,"200f6e4e",null);e["default"]=c.exports},8418:function(t,e,r){"use strict";var n=r("c04e"),i=r("9bf2"),o=r("5c6c");t.exports=function(t,e,r){var a=n(e);a in t?i.f(t,a,o(0,r)):t[a]=r}},a434:function(t,e,r){"use strict";var n=r("23e7"),i=r("23cb"),o=r("a691"),a=r("50c4"),s=r("7b0b"),c=r("65f0"),l=r("8418"),u=r("1dde"),d=r("ae40"),m=u("splice"),p=d("splice",{ACCESSORS:!0,0:0,1:2}),f=Math.max,b=Math.min,h=9007199254740991,g="Maximum allowed length exceeded";n({target:"Array",proto:!0,forced:!m||!p},{splice:function(t,e){var r,n,u,d,m,p,v=s(this),_=a(v.length),k=i(t,_),x=arguments.length;if(0===x?r=n=0:1===x?(r=0,n=_-k):(r=x-2,n=b(f(o(e),0),_-k)),_+r-n>h)throw TypeError(g);for(u=c(v,n),d=0;d<n;d++)m=k+d,m in v&&l(u,d,v[m]);if(u.length=n,r<n){for(d=k;d<_-n;d++)m=d+n,p=d+r,m in v?v[p]=v[m]:delete v[p];for(d=_;d>_-n+r;d--)delete v[d-1]}else if(r>n)for(d=_-n;d>k;d--)m=d+n-1,p=d+r-1,m in v?v[p]=v[m]:delete v[p];for(d=0;d<r;d++)v[d+k]=arguments[d+2];return v.length=_-n+r,u}})},ab01:function(t,e,r){var n={"./BookEdit.vue":"1deb","./BookPopular.vue":"46aa"};function i(t){var e=o(t);return r(e)}function o(t){if(!r.o(n,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return n[t]}i.keys=function(){return Object.keys(n)},i.resolve=o,t.exports=i,i.id="ab01"},caad:function(t,e,r){"use strict";var n=r("23e7"),i=r("4d64").includes,o=r("44d2"),a=r("ae40"),s=a("indexOf",{ACCESSORS:!0,1:0});n({target:"Array",proto:!0,forced:!s},{includes:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),o("includes")}}]);
//# sourceMappingURL=chunk-5e0c643d.2a68f733.js.map